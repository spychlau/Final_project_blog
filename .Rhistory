library(tidyverse)
distill::create_post("Correlation matrices")
data <- read_csv("data_syn.csv")
cormat %>%
gt::gt()
cormat <- round(cor(data), 2)
cormat %>%
gt::gt()
View(cormat)
cormat %>%
reactable::reactable()
cormat %>%
reactable::reactable(
pagination = FALSE
)
library(ggplot2)
cormat_long <- melt(cormat)
cormat_long <- reshape::melt(cormat)
cormat_long <- reshape2::melt(cormat)
ggplot(data = cormat_long, aes(Var2, Var1, fill = value))+
geom_tile(color = "white") +
scale_fill_gradient2(low = "#b35806", high = "#542788", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name="Correlation\nstrength") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 11, hjust = 1)) +
coord_fixed() +
labs(x = "",
y = "",
title = "Pearson correlations")
ggplot(data = cormat_long, aes(Var2, Var1, fill = value))+
geom_tile(color = "white") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name="Correlation\nstrength") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 11, hjust = 1)) +
coord_fixed() +
labs(x = "",
y = "",
title = "Pearson correlations")
ggplot(data = cormat_long, aes(Var2, Var1, fill = value))+
geom_tile(color = "white") +
scale_fill_gradient2(low = "firebrick2", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name="Correlation\nstrength") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 11, hjust = 1)) +
coord_fixed() +
labs(x = "",
y = "",
title = "Pearson correlations")
ggplot(data = cormat_long, aes(Var2, Var1, fill = value))+
geom_tile(color = "white") +
scale_fill_gradient2(low = "darkblue", high = "firebrick2", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name="Correlation\nstrength") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 11, hjust = 1)) +
coord_fixed() +
labs(x = "",
y = "",
title = "Pearson correlations")
library(ggcorrplot)
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 2,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
cormat_pearson <- rcorr(as.matrix(data), type = "pearson")
cormat_pearson <- Hmisc::rcorr(as.matrix(data), type = "pearson")
p.mat <- cormat_pearson$P
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 2,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 2,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "darkblue", high = "firebrick2", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggplot(data = cormat_long, aes(Var2, Var1, fill = value))+
geom_tile(color = "white") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name="Correlation\nstrength") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, vjust = 1, size = 11, hjust = 1)) +
coord_fixed() +
labs(x = "",
y = "",
title = "Pearson correlations")
ggcorrplot(cormat, method = "circle",
type = "lower",
lab_size = 2,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "circle",
type = "lower",
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "circle",
type = "lower",
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "circle",
type = "lower",
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 2,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank") +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 90) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 90, #I did not like the default 45 degree rotation
tl.cex = 12) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 90, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 30, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 80, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 70, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 600, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
lab = TRUE,
lab_size = 1.5,
title = "Pearson correlations\nOnly significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 60, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
ggcorrplot(cormat, method = "square",
type = "lower",
title = "Pearson correlations",
caption = "Only significant (alpha < .05) correlations shown",
hc.order = TRUE,
outline.col = "white",
p.mat = p.mat,
sig.level = 0.05,
insig = "blank",
tl.srt = 60, #I did not like the default 45 degree rotation
tl.cex = 10) +
scale_fill_gradient2(low = "#542788", high = "#b35806", mid = "#f7f7f7",
midpoint = 0, limit = c(-1, 1), space = "Lab",
name = "Correlation\nstrength")
distill::create_post("Correlation networks")
data <- read_csv("data_syn.csv")
library(corrr)
library(tidyverse)
library(tidygraph)
library(ggraph)
qgraph::qgraph(cormat,
graph = "pcor",
layout = "circle",
minimum = "sig",
sampleSize = 99,
posCol = c("#ef8a62", "firebrick2"),
negCol = c("#67a9cf", "darkblue"),
edge.labels = FALSE)
tidy_cors <- data %>%
correlate() %>%
stretch() %>%
arrange(desc(r))
graph_cors <- tidy_cors %>%
filter(abs(r) > 0.3) %>%
graph_from_data_frame(directed = FALSE)
graph_cors <- tidy_cors %>%
filter(abs(r) > 0.3) %>%
igraph::graph_from_data_frame(directed = FALSE)
# Plot
ggraph(graph_cors) +
geom_edge_link() +
geom_node_point() +
geom_node_text(aes(label = name), repel = TRUE) +
theme_void()
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey30", size = 5) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey20", size = 5) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey20", size = 5, nudge_x = 0.04, nudge_y = 0.08) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey20", size = 5, nudge_x = 0.1, nudge_y = 0.08) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey20", size = 5, nudge_x = 0.1, nudge_y = 0.1) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.1, nudge_y = 0.1) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.15, nudge_y = 0.1) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.15, nudge_y = 0.2) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.15, nudge_y = -0.2) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_y = -0.2) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.0.5, nudge_y = -0.2) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = "kk") +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), colour = "grey20", size = 5, nudge_x = 0.05, nudge_y = -0.2) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = 'linear', circular = TRUE) +
geom_edge_link(aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "grey30", size = 5, alpha = 0.8) +
geom_node_text(aes(label = name), nudge_x = 0.04, nudge_y = 0.08, size = 4, colour = "grey20", alpha = 0.85) +
theme_graph() +
labs(title = "Correlations between variables",
subtitle = "Plotted only if Pearson's r > .3")
ggraph(graph_cors, layout = "kk") +
geom_edge_arc(curvature=0.2, aes(edge_alpha = abs(r), edge_width = abs(r), color = r)) +
guides(edge_alpha = "none", edge_width = "none") +
scale_edge_colour_gradientn(limits = c(-1, 1), colors = c("darkblue", "firebrick2")) +
geom_node_point(color = "white", size = 5) +
geom_node_text(aes(label = name), repel = TRUE, colour = "grey30", size = 5) +
theme_graph() +
labs(title = "Correlations between variables")
ggraph(graph_cors, layout = 'linear', circular = TRUE) +
geom_edge_arc(aes(edge_alpha = abs(r),
edge_width = abs(r),
color = r)) +
scale_edge_colour_gradientn(limits = c(-1, 1),
colors = c("darkblue", "firebrick2")) +
geom_node_text(aes(label = name),
nudge_y = 0.07,
repel = TRUE,
colour = "grey10",
size = 5) +
geom_node_point(color = "grey20",
size = 5) +
theme_graph() +
labs(title = "Correlations between variables",
subtitle = "Plotted only if Pearson's r > .3") +
guides(edge_alpha = "none",
edge_width = "none") +
coord_fixed()
ggraph(graph_cors, layout = 'linear', circular = TRUE) +
geom_edge_arc(aes(edge_alpha = abs(r),
edge_width = abs(r),
color = r)) +
scale_edge_colour_gradientn(limits = c(-1, 1),
colors = c("darkblue", "firebrick2")) +
geom_node_text(aes(label = name),
nudge_y = 0.08,
nudge_x = 0.06,
colour = "grey10",
size = 5) +
geom_node_point(color = "grey20",
size = 5) +
theme_graph() +
labs(title = "Correlations between variables",
subtitle = "Plotted only if Pearson's r > .3") +
guides(edge_alpha = "none",
edge_width = "none") +
coord_fixed()
qgraph::qgraph(cormat,
graph = "pcor",
layout = "circle",
minimum = "sig",
sampleSize = 99,
posCol = c("#ef8a62", "firebrick2"),
negCol = c("#67a9cf", "darkblue"),
edge.labels = FALSE)
View(data)
ggplot2::ggplot(data, aes(vofreq)) +
geom_histogram()
ggplot2::ggplot(data, aes(vofrequ)) +
geom_histogram()
ggplot2::ggplot(data, aes(vofrequ)) +
geom_histogram() +
theme_minimal()
